# 第二章 布尔运算

本章旨在利用逻辑门中的电路来构建一些完整功能的逻辑运算,ALU 是核心单元,他执行所有的算数逻辑,.所以如果想理解中央处理器(Centeral Processing Unit, CPU) 以及整个计算机的工作方式,构建 ALOU 功能模块是必不可少的步骤.

二进制加法是简单的操作,大部分数字计算机执行的操作能能够简化为基本的二进制数字的加法,因此,要实现大量依赖于二进制的加法计算机操作,其中最重要的是从构造器 的角度去理解二进制加法.

## Background Knowledge

(10011) = 1*2^4 + 0*2^3 + 0*2^2 + 1*2^1 + 1\*2^0

但其实真正在寄存器中存储的方式是,如果你的机器是,32 位机器 => `00000000 00000000 00000000 00010011`,这取决于你的总线带宽.

### 带符号的二进制编码以及补码

|   正数   |   负数    |
| :------: | :-------: |
| 0 - 0000 |           |
| 1 - 0001 | -1 - 1111 |
| 2 - 0010 | -2 - 1110 |
| 3 - 0011 | -3 - 1101 |
| 4 - 0100 | -4 - 1100 |
| 5 - 0101 | -5 - 1011 |
| 6 - 0110 | -6 - 1010 |
| 7 - 0111 | -7 - 1001 |
|          | -8 - 1000 |

### 二进制加法

两个二进制数字能够从右至左一位一位相加,跟十进制一样,首先,吧两个数字最右边的一位(LSB Least Significant Bits)加起来.然后将两个数的进位和地位二位数字相加,如果最后两位数字相加进 1,则说明它产生了溢出,否则就说明加法执行成功;

### 有符号的二进制数字

n 位二进制系统可以产生 2^n 个不同的组合.如果必须采用二进制码表表示有符号数,将 0xxx 表示正数,1xxx 表示负数.

### 半加器

用于进行 2 位加法运算

Carry: And 门
Sum: Xor 门

### 全加器

用于进行 3 位数加法
第一位:直接运用两次相加逻辑即可
第二位:HalfAdder(a,b)相加出现进位, 或者 HalfAdder(ab,c)相加出现进位,那么最终进位都是 1 否则为 0

```hdl
HalfAdder(a=a, b=b, sum=ab, carry=car);
HalfAdder(a=c, b=ab, sum=sum, carry=s);
Or(a=car, b=s, out=carry);
```

### 加法器

用于进行 n-1 位数加法
其实就是一个自增器
`Add16(a=in, b[0]=true, out=out);`

### ALU(Arithmetic Logic Unit) **重点**

**算数逻辑单元** 这个是计算机平台的核心部分,同时,ALU 的设计原则是相当通用.ALU 体系结构通过最小的逻辑单元来实现大量功能,从这点来看,它是设计中高效和优良设计的典范/

Hac 的 ALU 计算一组固定的函数 out=f1(x,y),这里的 x 和 y 是芯片的两个 16 位输入.out 是芯片 16 位的输出,f 是位于一个函数表中的函数,该函数由 18 个固定函数组成,我们通过设置 6 个称为控制位的输入位来告诉 ALU 用哪个函数进行何种函数计算

要注意的是,这 6 个控制位的每一位指示 ALU 来执行某个基本操作.这些操作的各种组合可以让 ALU 计算多种有用的函数.因为全部都是由 6 个控制位引起的,那么 ALU 可以对 2^64 个不同的函数进行操作.

可以看到的是,我们是通过 6 个控制位设置成函数 f(x,y)所对应的编码,来指示 ALU 计算该函数.从这点看来.ALU 内部逻辑应该产生如下图输出值.

### ALU Can Computes one of the following functions

according to 6 input bits denoted zx,nx,zy,ny,f,no

x+y, x-y, y-x, 0, 1, -1, x, y, -x, -y, !x, !y,

x+1, y+1, x-1, y-1, x&y, x|y on two 16-bit inputs,

### Control bits

| zx  | nx  | zy  | ny  |      f      |    no    |   out    |
| :-: | :-: | :-: | :-: | :---------: | :------: | :------: |
| x=0 | !x  | y=0 | !y  | x+y -/- x&y | out=!out | out(x,y) |
|  1  |  0  |  1  |  0  |      1      |    0     |    0     |
|  1  |  1  |  1  |  1  |      1      |    1     |   1???   |
|  1  |  0  |  1  |  0  |      1      |    0     |    -1    |
|  0  |  0  |  1  |  1  |      0      |    0     |    x     |
|  1  |  1  |  0  |  0  |      0      |    0     |    y     |
|  0  |  0  |  1  |  1  |      0      |    1     |    !x    |
|  1  |  1  |  0  |  0  |      0      |    1     |    !y    |
|  0  |  0  |  1  |  1  |      1      |    0     |    -x    |
|  1  |  1  |  0  |  0  |      1      |    0     |    -y    |
|  0  |  1  |  1  |  1  |      1      |    1     |   x+1    |
|  1  |  1  |  0  |  1  |      1      |    1     |   y+1    |
|  0  |  0  |  1  |  1  |      1      |    0     |   x-1    |
|  1  |  1  |  0  |  0  |      1      |    0     |   y-1    |
|  0  |  0  |  0  |  0  |      1      |    0     |   x+y    |
|  0  |  1  |  0  |  0  |      1      |    1     |   x-y    |
|  0  |  0  |  0  |  1  |      1      |    1     |   y-x    |
|  0  |  0  |  0  |  0  |      0      |    0     |   x&y    |
|  0  |  1  |  0  |  1  |      0      |    1     |   x\|y   |
